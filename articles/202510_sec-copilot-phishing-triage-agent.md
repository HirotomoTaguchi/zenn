---
title: "Microsoft Security Copilot Phishing Triage Agent に可能性を感じた話"
emoji: "🛡" 
type: "tech" ## tech: 技術記事 / idea: アイデア記事
topics: [Microsoft Defender, Security] 
published: false
---

Microsoft Security Copilotをこれまで検証で使ってきて、「あれば便利」という感想は持っていたものの、正直なところ「これは革命的だ!費用対効果が凄まじい！」と心から思えるユースケースには出会えていませんでした。しかし、Microsoft Security Copilot Phishing Triage Agentを試してみて、これは実用的かもしれないと可能性を感じることができたので、その体験をシェアしたいと思います。

## Phishing Triage Agentとは?

Microsoft Security Copilot Phishing Triage Agentは、ユーザーから報告されたフィッシングメールを自動的にトリアージしてくれる機能です。フィッシングは古典的な攻撃手法ですが、攻撃者にとって有効な攻撃手法であり続けています。Microsoft Digital Defense Report 2024^[[Microsoft Digital Defense Report 2024](https://www.microsoft.com/en-us/security/security-insider/threat-landscape/microsoft-digital-defense-report-2024?msockid=0d4bd66716e762e62137c358170d6324)] によると、2023年にはフィッシング攻撃が58%増加しており、2023年7月から2024年6月の間だけでも Microsoft Defender for Office 365 が 7億7,500万通のマルウェア添付されたフィッシングを検出しています。また、以前はフィッシングでは日本語が不自然など見分けるのが比較的容易でしたが、最近は、生成AIの進化が相まってメール本文・連携先のサイトのクオリティが爆発的に向上し、見分けが困難になってきました。さらに、2023年9月中旬頃からQRコード・フィッシングが急激に増加しており、この手法では従来のセキュリティツールでの検出が難しいという点もあります。

https://x.com/HirotomoTaguchi/status/1935679247596827008

### 具体的な動作フロー

ユーザーがフィッシングメールを報告すると、Agentは以下のような多角的な調査を実施します。これらの調査結果を総合的に判断し、真のフィッシングメール(True)か否かを判定してくれます。

- 本文やヘッダー情報を詳細に解析
- サンドボックス環境でメールを実行
- 社内の訓練メールかどうかを確認
- メールのローデータを精査
- メールのスクリーンショットからフィッシングの兆候を検出
- 送信元との通信状態を分析

## 何が良かったのか?

### 1. AIだからこそ見せられるコンテンツ

これが個人的に最も画期的だと感じた点です。メールには、セキュリティ担当者に見せること自体が憚られる機微情報が含まれることがあります。SOCのコストを下げるために、インドやマレーシア等の物価の安い国にSOCをオフシェアしている企業も多かったりしますが、ラージエンタープライズや政府機関になると産業スパイなどのリスクも懸念しなければならず、メールへのアクセス権を渡すことに懸念が生じます。

しかしAIであれば、人間よりも信頼して分析を任せることができます。これは地味ですが、実務上非常に大きなメリットです。（マイクロソフトが信頼できるのか？という話がありますが、そもそもメールデータはExchangeの中にありますし、信じられないほど厳しいセキュリティ体制を実施しているので、その辺の安いSOCベンダーのアナリストよりは遥かに信頼できると考えています。）

### 2. 半自動化による効率化

現時点でも半自動で動作しますが、将来的にはTier1アナリストの業務を大幅に任せられる可能性を感じました。

### 3. コンテキストは既にMicrosoft 365の中に!

Security Copilotの強みは、Microsoft 365環境内の豊富なコンテキスト情報に容易にアクセスできる点にあります。メールヘッダー、送信元の評判情報、過去のフィッシングキャンペーンデータ、テナント内の通信履歴など、判断に必要な情報がすべてエコシステム内に揃っています。

AIは完璧ではありませんが、正しい情報とコンテキストを与えれば、新卒1-2年目のアナリストよりも正確性が高い判断ができると個人的には考えいます。そして、AI活用は如何にそのコンテキストを与えられるかが重要だと考えています。（よく「AIレディなデータ」とかいうやつですね）このため、外部のLLMに情報を入力する場合と異なり、文脈に沿った精度の高い分析が可能になります。もちろん、ベテランアナリストの直感や経験には及びませんが、大量の定型的なトリアージ業務においては、十分に実用的なレベルに達していると感じました。

## 今後の課題

### 1. ワークフローの自動化

現状ではトリアージ結果を確認して終わりですが、実運用では以下のような連携が必要です。

- フィッシングと判定された場合、Logic Appsを起動して関係者に自動通知
- メールの削除やユーザーへのフォローアップを自動化

### 2. 費用対効果の問題

この点が最も悩ましい課題です。**ラージエンタープライズ企業**の場合、日々大量のフィッシング報告が寄せられるため、導入効果が出る可能性があります。一方、**中小規模の企業**では、Security Copilotを常時稼働させるコストに対して、処理するフィッシング報告の件数が見合わない可能性があります。月に数件程度の報告であれば、人力で対応した方が安上がりかもしれません。

### 3. フィッシング以外のユースケース

フィッシングトリアージ以外にも、Security Copilotを活用できる場面は多いはずです。しかし、現時点では他の業務で同等の効果を実感できるユースケースを見つけられていません。（僕の検証が甘いだけかもしれませんが）今後、さまざまな業務で試していく必要があります。何か見つけたら教えてください。

## DLP Triage Agentへの期待

なお、DLP(Data Loss Prevention)トリアージエージェントも似たような仕組みで提供されているとドキュメントからは見えています。こちらはまだ本格的に試せていませんが、データ漏洩の誤検知/真陽性の判断を自動化できるという意味で、Phishing Triage Agentと同様の可能性を感じています。特に、DLPアラートは誤検知が多く、アナリストの負担が大きい領域です。ここをAIで効率化できれば、セキュリティチームの生産性は大幅に向上するでしょう。加えて、DLPはフィッシングと比較してかなり機微な情報を取り扱います。そういう意味でAIでレビューすることの価値を感じやすいユースケースだと思います。

## まとめ

Microsoft Security Copilot Phishing Triage Agentは、私がSecurity Copilotで初めて可能性を感じた機能です。完璧ではありませんが、適切に設計・運用すれば、Tier1アナリストの業務負荷を大きく軽減できる可能性があります。

特に大規模組織においては、今すぐにでも導入を検討する価値があると感じました。一方で、中小企業では費用対効果を慎重に見極める必要があるでしょう。

AIセキュリティツールの実用化はまだ始まったばかりです。今後、さまざまなユースケースでの活用が進み、セキュリティ業務の在り方が変わっていくことを期待しています。
