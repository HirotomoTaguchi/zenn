---
title: "Microsoft Security Copilot Phishing Triage Agent に可能性を感じた話"
emoji: "🛡" 
type: "idea" ## tech: 技術記事 / idea: アイデア記事
topics: [Microsoft Defender, Security] 
published: false
---

マイクロソフトに怒られるかもしれませんが、Microsoft Security Copilotをこれまで検証で使ってきて、「あれば便利」という感想は持っていたものの、正直なところ「すぐ導入すべきだ！」と心から思えるユースケースには出会えていませんでした。下記のブログのように、Copilot for Security (のようなもの) を自作する方もいらっしゃいますし、僕的にもLogic Appsやらでフローを組んだり、定型化できないものは Microsoft 365 Copilot のチャットに投げたりしていました。

https://zenn.dev/microsoft/articles/103ea16dc6e977

しかし、Microsoft Security Copilot Phishing Triage Agentを試してみて、フィッシング対応という狭い範囲ではありますが、将来実用的になるかもしれないという可能性を感じることができたので、乾燥をシェアしたいと思います。今すぐ万人が入れて嬉しいものではないかもしれませんが、将来の可能性も踏まえてみていただけたら幸いです。

## たかがフィッシング？されどフィッシング

フィッシングは古典的な攻撃手法ですが、初期アクセスの手口として攻撃者にとって有効な攻撃手法であり続けています。Microsoft Digital Defense Report 2024^[[Microsoft Digital Defense Report 2024](https://www.microsoft.com/en-us/security/security-insider/threat-landscape/microsoft-digital-defense-report-2024?msockid=0d4bd66716e762e62137c358170d6324)] によると、2023年にはフィッシング攻撃が58%増加しており、2023年7月から2024年6月の間だけでも Microsoft Defender for Office 365 が 7億7,500万通のマルウェア添付されたフィッシングを検出しています。

## Phishing Triage Agentとは?

Microsoft Security Copilot Phishing Triage Agent^[[Microsoft Security Copilot Phishing Triage Agent in Microsoft Defender (Preview)](https://learn.microsoft.com/en-us/defender-xdr/phishing-triage-agent)]は、ユーザーから報告されたフィッシングメールを自動的にトリアージしてくれる機能です。もちろん、M365にはデフォルトの強いフィルターが備わっており、ユーザーに到達する前に止めてくれるケースが大多数を占めています。一方で、100％で止めることが難しいため、ユーザー教育⇒報告⇒報告されたものの影響確認も引き続き重要です。

![](https://github.com/user-attachments/assets/be73321c-8b64-402d-9adc-a9c6dfb915dd)


### 具体的な調査内容

ユーザーがフィッシングメールを報告すると、Agentは以下のような多角的な調査を実施します。これらの調査結果を総合的に判断し、真のフィッシングメール(True)か否かを判定してくれます。

＜調査観点例＞

- 本文やヘッダー情報を詳細に解析
- サンドボックス環境でメールを実行
- 社内の訓練メールかどうかを確認
- メールのローデータを精査
- メールのスクリーンショットからフィッシングの兆候を検出
- 送信元との通信状態を分析

![](https://github.com/user-attachments/assets/d6c1c909-9522-4400-b64a-191d541acec7)

## どんな可能性を感じたのか？

### AIだからこそ見せられるコンテンツ

これが個人的に最も画期的だと感じた点です。メールには、セキュリティ担当者に見せること自体が憚られる機微情報が含まれることがあります。SOCのコストを下げるために、インドやマレーシア等の物価の安い国にSOCをオフシェアしている企業も多かったりしますが、ラージエンタープライズや政府機関になると産業スパイなどのリスクも懸念しなければならず、メールへのアクセス権を渡すことに懸念が生じます。

しかしAIであれば、人間よりも信頼して分析を任せることができます。これは地味ですが、実務上非常に大きなメリットです。（マイクロソフトが信頼できるのか？という話がありますが、そもそもメールデータはExchangeの中にありますし、信じられないほど厳しいセキュリティ体制を実施しているので、その辺の安いSOCベンダーのアナリストよりは遥かに信頼できると考えています。）

### 自動化による効率化

この機能の良いところは、プロンプトを打たなくても勝手に動作する点です。プロンプトを打つタイプのサービスも嫌いではありませんが、組織として導入のインパクトが出やすいのは業務に深く組みこんでいくパターンです。将来的には、他のユースケースも併せて、Tier1アナリストの業務を大幅に任せられる可能性を感じたのが今日のブログの一番の趣旨です。

![](https://github.com/user-attachments/assets/c13e8272-283c-472e-8891-fc52cfca24c4)


### コンテキストは既にMicrosoft 365の中に！

AIは完璧ではありませんが、とはいえこれだけAIが賢くなった今、正しい情報とコンテキストを与えれば新卒1-2年目のアナリストよりも正確性が高い判断ができると個人的には考えています。AIは責任を取ってくれないという点には注意しながらも、AI活用は如何にそのコンテキストを与えられるかが勝負だと考えています。（よく「AIレディなデータ」とかいうやつですね。この言葉はあまり好きではありませんが・・・）

Security Copilotの強みは、Microsoft 365環境内の豊富なコンテキスト情報に容易にアクセスできる点にあります。メールヘッダー、送信元の評判情報、過去のフィッシングキャンペーンデータ、テナント内の通信履歴など、判断に必要な情報がすべてエコシステム内に揃っています。このため、外部のLLMに情報を入力する場合と異なり、コンテキストを集めやすく、文脈に沿った精度の高い分析が可能になります。

## 今後の課題

### ワークフローの自動化

現状ではトリアージ結果を確認して終わりですが、実運用では以下のような連携が必要です。

- フィッシングと判定された場合、Logic Appsを起動して関係者に自動通知
- メールの削除やユーザーへのフォローアップを自動化

### 費用対効果の問題

この点が最も悩ましい課題です。**ラージエンタープライズ企業**の場合、日々大量のフィッシング報告が寄せられるため、導入効果が出る可能性があります。一方、**中小規模の企業**では、Security Copilotを常時稼働させるコストに対して、処理するフィッシング報告の件数が見合わない可能性があります。月に数件程度の報告であれば、人力で対応した方が安上がりかもしれません。

### フィッシング以外のユースケースもほしいよね

フィッシングトリアージ以外にも、Security Copilotを活用できる場面は多いはずです。しかし、現時点では他の業務で同等の効果を実感できるユースケースを見つけられていません。（僕の検証が甘いだけかもしれませんが）今後、さまざまな業務で試していく必要があります。この記事を見ている皆さまも何か見つけたら教えてください。

なお、そういった意味では、別機能のPurviewのDLP・InsiderRiskトリアージエージェント^[[Introducing Microsoft Purview Alert Triage Agents for Data Loss Prevention & Insider Risk Management](https://techcommunity.microsoft.com/blog/microsoftmechanicsblog/introducing-microsoft-purview-alert-triage-agents-for-data-loss-prevention--insi/4424401)]も期待すべき機能だと思っています。こちらはまだ本格的に試せていませんが、データ漏洩の誤検知/真陽性のトリアージエージェントできるという意味で、Phishing Triage Agentと同様の可能性を感じています。特に、DLPアラートは誤検知が多く、アナリストの負担が大きい領域です。ここをAIで効率化できれば、セキュリティチームの生産性は大幅に向上できないかと期待しています。

加えて、DLPはフィッシングよりもかなり機微な情報を取り扱います。漏洩させたらダメだということは、やすやすとSOCのアナリストに見せるわけにもいきません。そういう意味でAIでレビューする価値を感じやすいユースケースだと思います。

## まとめ

Microsoft Security Copilot Phishing Triage Agentは、私がSecurity Copilotで初めて可能性を感じた機能です。完璧ではありませんが、適切に設計・運用すれば、Tier1アナリストの業務負荷を大きく軽減できる可能性があります。特に大規模組織においては価値があると感じました。一方で、中小企業では費用対効果を慎重に見極める必要があるでしょう。AIセキュリティツールの実用化はまだ始まったばかりです。今後、さまざまなユースケースでの活用が進み、セキュリティ業務の在り方が変わっていくことを期待しています。
