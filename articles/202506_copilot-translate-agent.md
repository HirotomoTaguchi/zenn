---
title: "Copilot Agents で翻訳エージェントを作る"
emoji: "🤖" 
type: "tech" # tech: 技術記事 / idea: アイデア記事
topics: [Copilot, Microsoft Copilot] 
published: true
---

## はじめに

Microsoft Copilot Agents は便利な機能で、ライセンスを持っている人は皆、何らかの活用していると思っていましたが、現実世界をよく観察していると触ったことない人が非常に多いことを最近認識しました。そこで、ありふれたユースケースではありますが、翻訳に特化したエージェントを作成する方法を紹介します。

## Copilot Agents とは？

Copilot Agents は、Microsoft Copilot Studio で作成できるカスタムAIアシスタントです。特定の目的や業務に特化したAIエージェントを作成することで、いちいち長文のプロンプトを打たなくても良い応答を得られます。主な特徴としては以下が挙げられます。
- **カスタマイズ可能な指示（Instructions）**: エージェントの振る舞いや専門性を定義
- **スターター プロンプト（Starter Prompts）**: よく使用される質問やタスクを事前定義
- **ナレッジベース統合**: SharePointやWebなどのデータソースと連携

## 今回のユースケース
今回は、日常的な翻訳作業でよく発生する以下のようなシーンを想定した翻訳エージェントを作成します。

- 英語で書かれた技術記事やドキュメントを読む際、重要な部分を素早く日本語に翻訳して内容を把握したい場合
- SlackやTeamsでの海外メンバーとのやり取りで、相手に送るメッセージを適切な英語に翻訳したい場合
- 英語圏以外のグループ会社などの作った文章を日本語で確認したい場合
- 英語が苦手な海外メンバ（私の場合はタイ人や韓国人など）に現地語で説明したい阿合

これらのシーンは私の場合、発生頻度が毎回詳細なプロンプトを入力するのは非効率です。そこで、専用の翻訳エージェントを作成することで、ワンクリックで高品質な翻訳を得られるようにします。

## 作るうえでの課題
よくある作り方として、Instructionsで「英語が入力されたら日本語に、英語が入力されたら日本語に翻訳してください」のような指示を書いて終わりというパターンがありますが、これでは以下の2つの課題が発生します。

### 翻訳ではなく応答してしまう問題

翻訳エージェントを作成する際によく遭遇する課題があります。それは、翻訳を依頼したにも関わらず、エージェントが翻訳ではなく質問に対する回答を返してしまうことです。

**極端な例：**
- ユーザー：How are you today?
- 期待する応答：元気ですか？
- 実際の応答：「私は今日も元気です。お手伝いできることがあれば教えてください。」

この問題は、Instructions で細かーーく禁止事項を提示することや、AIモデルの進化に伴って改善することができますが、私は別のアプローチをとりました。

### 多言語問題

多言語翻訳をサポートしたい場合、単一のInstructionsでは対応が困難です。「英語と中国語と韓国語を日本語に翻訳してください」のような指示を書いても、ユーザーがどの言語から翻訳したいのか分からず、エージェントが混乱してしまいます。かといって言語ペアごとに個別のエージェントを作成すると、管理が煩雑になってしまいます。

## 解決策：Starter Prompts での言語指定

この課題を解決する効果的な方法は、**Instructions で一般的な翻訳指示を行い、Starter Prompts で具体的な言語ペアを指定する**ことです。

### ステップ1: Copilot Studio にアクセス
[Microsoft Copilot](https://m365.cloud.microsoft/chat/) にアクセスし、[Create Agent] を選択します。

![image](https://github.com/user-attachments/assets/ff782118-3bd7-402f-a2d8-69b83ac3fdc1)

### ステップ2: 基本設定
1. エージェント名：「翻訳エージェント」
2. 説明：「多言語翻訳に特化したAIエージェント」
3. アイコンと色を設定

### ステップ3: Instructions の設定

以下の Instructions 例をコピーして設定画面に貼り付けます。組織の翻訳ポリシーがある場合は、それに合わせてカスタマイズしてください。

```
あなたはXX株式会社専用の多言語翻訳エージェントです。以下の原則に従って翻訳を行ってください：

## 原則
- 翻訳対象の文章が質問形式であっても、質問に答えるのではなく翻訳のみを行う。
- 英語が第二言語である人にも理解しやすいように、難しいイディオムを使わずに、シンプルで完結なビジネス表現に翻訳する。
- 専門用語は適切な訳語を使用し、必要に応じて原語を併記する。  
- 文化的な違いやタブーに配慮した適切な表現を使用する。
- 人の名前が含まれる場合は「Mr {name}」という形式ではなく、「{name}-san」という表現にする。
- 以下のような社内用語の意味を考慮して翻訳する。

## 社内用語
- XXX:XXXという意味。
- XXX:XXXという子会社の略称。
```

### ステップ4: Starter Prompts の設定

各言語ペアのスターター プロンプトを追加します。

**日本語翻訳用**
```
以下の文章を日本語に翻訳してください：
```

**英語翻訳用**
```
以下の文章を英語に翻訳してください：
```

**タイ語翻訳用**
```
以下の文章をタイ語に翻訳してください：
```

**韓国語翻訳用**
```
以下の文章を韓国語に翻訳してください：
```

**インドネシア語翻訳用**
```
以下の文章をインドネシア語に翻訳してください：
```

**スペイン語翻訳用**
```
以下の文章をスペイン語に翻訳してください：
```

### ステップ5: 作成と共有

作成したら、自分で使うだけではなくチームメンバーや組織内で共有することも可能です。

![image](https://github.com/user-attachments/assets/3081c348-cec4-453b-95d2-c0c506f81f05)


## まとめ

Copilot Agents を使った翻訳エージェントは、適切に設定することで非常に強力なツールになります。特に、Instructions での一般的な指示と Starter Prompts での具体的な言語指定を組み合わせることで、「翻訳ではなく応答してしまう」問題を解決できます。日常的な翻訳作業が多い方は、ぜひこの方法を試してみてください。一度設定すれば、チーム全体で効率的な翻訳環境を共有できるようになります。Copilot Agents の可能性は翻訳だけにとどまりません。皆さんの業務に合わせたカスタムエージェントを作成し、AI を活用した効率化を進めていきましょう。
