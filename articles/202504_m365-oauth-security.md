---
title: "Microsoft 365 における OAuth アプリケーションのリスクと対策"
emoji: "💻" 
type: "tech" # tech: 技術記事 / idea: アイデア記事
topics: [security, Microsoft 365] 
published: false
---

## はじめに

本記事では、Microsoft 365環境におけるOAuthアプリケーションの主要なリスクと、それに対する具体的な対策について解説します。特に、最近増加しているOAuthを悪用した攻撃手法と、それらを防ぐために考えられる対策について言及します。

## OAuthとは何か

OAuthはユーザーのパスワードを共有することなく、第三者アプリに限定されたリソースアクセス権を委譲できる認可のプロトコルです。Microsoft 365 では Azure AD (現 Entra ID)が OAuth 2.0 の基盤を提供しており、ユーザーがアプリにサインインする際に「同意画面」が表示されます。この同意を行うと、同意時に許可した権限において、第三者アプリが Microsoft 365 テナント上の情報にアクセスします。Microsoft 365の環境では、OAuthは以下のような場面で広く利用されています。

,

- モバイルアプリからのメールアクセス
- サードパーティのカレンダー連携
- ドキュメント管理ツールとの連携
- カスタム業務アプリケーションの統合

## OAuth を悪用したリスク事例

このように便利な機能である一方で、適切な管理が行われないと、組織のセキュリティに重大な影響を与える可能性があります。以下では、OAuthを悪用した具体的なリスク事例と、それに対する対策について説明します。

### 1. 過剰な権限要求によるデータ漏洩

一見無害なアプリが、必要以上の権限 (Mail.ReadWriteやFiles.Read.All 等)を要求し、ユーザーが同意することで、悪意のデータ消失が起きます。

### 2. コンセントフィッシング

Microsoft 公式の同意画面を補ふしたフィッシングメールにより、ユーザーに OAuth の同意をさせる手法です。

### 3. 永続的トークンによる接続維持

OAuth の offline_access スコープを通じて発行される refresh token により、ユーザーのログアウト後も接続維持が可能となります。

### 4. Microsoft 自身が対応した事例

Verified Publisher を悪用した OAuth アプリが Azure AD に登録され、同意を得たユーザーのメールなどが漏洩した事例があります。Microsoft はこの事案で対象アプリを強制無効化しました。

## Microsoft 365 でできる対策

### 1. OAuth アプリの見える化 & 管理

Microsoft Defender for Cloud Apps の App Governance 機能を使うことで、統合ダッシュボードで OAuth アプリの発見、リスク分析、ポリシー設定が可能です。

### 2. アプリ同意ポリシーの定義

Entra ID では、同意を許可するアプリの条件を設定できます。確認済み発行元みのアプリのみユーザー同意を許可するなど、素性をベースに管理することが可能です。

### 3. 条件付きアクセス

Token Protection や CAE (続行的アクセス評価)を組み合わせ、不正なトークン利用を検知・無効化することが可能です。

### 4. ユーザー教育と監視体制

OAuth 同意のリスクを理解させ、見返しがつくようなアプリへの同意を抵抗するよう教育を行いましょう。同時に Entra ID のログや Defender からのアラートを添えて監視を強化します。

## 終わりに

Microsoft 365 環境におけるOAuthアプリケーションのセキュリティは、組織の重要な資産を守る上で不可欠な要素です。これらの対策を組み合わせることで、OAuthを悪用した攻撃から組織を守りながら、必要な業務効率化を実現していきましょう。
